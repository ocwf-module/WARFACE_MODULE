# Создание PAK-архивов для CryEngine и Warface

## Процесс создания

Чтобы создавать правильные PAK-архивы нужно, чтобы файлы в них были правильно архивированы (сжаты), не всегда обычные архиваторы с этим справляются и тем самым файлы становятся нечитаемы для движка и игры, поэтому необходимо использовать программу \[7za.exe\] она входит в состав редактора и располагается по пути: \[MSDK_Editor/Tools/CryArchiver/\]. Порядок действий:
1. Перенесите папку с программой в удобное для вас место;
2. Перенесите в папку с программой папку или файл, которые вам нужно запаковать в pak-архив;
3. Откройте командную строку или PowerShell;
4. Пропишите: cd "полный путь до данной программы в вашей системе" (без кавычек) и нажмите Enter;

	4.1 Например: ```cd C:\CryEngine\CryArchiver```

5. Далее вписываете данную команду: 

	5.1 Для командной строки (папка): ```7za a -tzip -mx0 -r Name_Archive.pak Name_Folder\*.*```

	5.2 Для командной строки (файл): ```7za a -tzip -mx0 -r Name_Archive.pak Name_File```

	5.3 Для командной строки (файлы и папки): ```7za a -tzip -r -mx0 Name_Archive.pak Name_File1, Name_File2 Name_Folder1\*.* Name_Folder2\*.*```

	5.4 Для PowerShell перед командами добавляете ```.\```

6. Ваш pak-архив готов! (Он появился в той же папке, где и программа).

## Пояснение за каждый аргумент в команде

```7za``` - название программы;

```a``` - добавить файл в архив (если архива не существует, то создать и добавить, поддерживает замену файла);

```-tzip``` - тип архива (в данном случае: zip);

```-mx0``` - степень сжатия (в данном случае степень сжатия равна 0, при этом значении файлы запаковываются без сжатия);

```-r``` - рекурсировать подкаталоги (лично я точно не знаю, но так надо);

```Name_Archive.pak``` - это желаемое название вашего будущего архива (для CryEngine и Warface обязательно расширение \[.pak\]);

```Name_Folder\*.*``` - это название папки, которую вам нужно запаковать, *.* - позволяет запаковать всё её содержимое;

```Name_File``` - название файла, который вам нужно запаковать (файлы указывать с расширением! Например: test.xml);

В случае, если вы хотите запаковать несколько файлов и папок одновременно, то файлы указываете через запятую, а папки через пробел

## Примеры использования

Архивирование папки: ```7za a -tzip -mx0 -r Texture.pak Textures\*.*```

Архивирование файла: ```7za a -tzip -mx0 -r Texture.pak sky.dds```

Архивирование папок и файлов: ```7za a -tzip -r -mx0 Texture.pak sky_day.dds, sky_night.dds Textures\cubemaps\*.* Textures\decals\*.*```

# Небольшая документация к программе 7za.exe

7za - Файловый архиватор с высочайшей степенью сжатия.

## Описания

7-Zip - это файловый архиватор с наивысшей степенью сжатия. Программа поддерживает 7z (который реализует алгоритм сжатия LZMA), LZMA2, XZ, ZIP, Zip64, CAB, RAR (если несвободный установлен пакет p7zip-rar), ARJ, GZIP, BZIP2, TAR, CPIO, RPM, ISO, большинство форматов файловых систем образы и DEB. Степень сжатия в новом формате 7z на 30-50% выше, чем ratio в формате ZIP.

7za - это автономный исполняемый файл. 7za обрабатывает меньше форматов архивов, чем 7z.

## Фунциональные буквы

```a``` - Добавить

```d``` - Удалить

```e``` - Извлечь

```l``` - Список

```t``` - Тест

```u``` - Обновить

```x``` - Извлекать с полными путями

## Переключатели:

```-ai[r[-|0]]{@listfile|!wildcard}``` - Включить архивы

```-ax[r[-|0]]{@listfile|!wildcard}``` - Исключить архивы

```-bd``` - Отключить процентный индикатор

```-i[r[-|0]]{@listfile|!wildcard}``` - Включить имена файлов

```-l``` - не хранит символические ссылки; храните файлы / каталоги, на которые они указывают (ВНИМАНИЕ: этап сканирования может никогда не завершиться из-за рекурсивных символических ссылок, таких как 'ln -s .. ldir')

```-m{Parameters}``` - Установите метод сжатия (см. /usr/share/doc/p7zip-full/DOCS/MANUAL/switches/method.htm список методов)

```-mhe=on|off``` - только формат 7z: включает или отключает шифрование заголовка архива (по умолчанию: выключено)

```-o{Directory}``` - Установите выходной каталог

```-p{Password}``` - Установите пароль

```-r[-|0]``` - Рекурсируйте подкаталоги (ВНИМАНИЕ: этот флаг не выполняет то, что вы думаете, избегайте его использования)

```-sfx[{name}]``` - Создайте архив SFX

```-si``` - Считывает данные из StdIn (например: tar cf - directory | 7za a -si directory.tar.7z)

```-so``` - Запись данных в стандартный вывод (например: % echo foo | 7z фиктивный файл -tgzip -si -so > /dev/null)

```-slt``` - Устанавливает технический режим для команды l (список)

```-t{Type}``` - Типы архива (7z, zip, gzip, bzip2 или tar. 7z - по умолчанию)

```-v{Size}[b|k|m|g]``` - Создание томов

```-u[-][p#][q#][r#][x#][y#][z#][!newArchiveName]``` - Параметры обновления

```-w[path]``` - Установить рабочий каталог

```-x[r[-|0]]]{@listfile|!wildcard}``` - Исключить имена файлов

```-y``` - Предполагать, что "Да" по всем запросам

## Диагностика

7-Zip возвращает следующие коды выхода:

```0``` - Нормально (ошибок или предупреждений не обнаружено)

```1``` - Предупреждение (неустранимые ошибки). Например, некоторые файлы не могут быть прочитаны во время сжатия. Таким образом, они не были сжаты

```2``` - Фатальные ошибки

```7``` - Неверных параметров командной строки

```8``` - Недостаточно памяти для работы

```255``` - пользователи остановили процесс с помощью control-C (или аналогичного)

## Резервное копирование и ограничения

НЕ ИСПОЛЬЗУЙТЕ формат 7-Zip для резервного копирования в Linux / Unix, потому что:

- 7-zip не хранит владельца / группу файла.

В Linux / Unix для резервного копирования каталогов вы должны использовать tar:

- для создания резервной копии каталога: tar cf - directory | 7za a -si directory.tar.7z

- для восстановления резервной копии: 7za x -so directory.tar.7z | tar xf -

Если вы хотите отправлять файлы и директории (не владельцу файла) другим пользователям Unix / macOS / Windows, вы можете использовать формат 7-zip.
- пример: 7za a directory.7z directory

Не используйте "-r", потому что этот флаг не делает того, что вы думаете.

Не используйте directory/* из-за файлов ".*" (пример: "directory /*" не соответствует "directory /.profile")

## Несколько статей про систему CryPak в CryEngine

https://docs.cryengine.com/display/SDKDOC4/CryPak

https://docs.cryengine.com/display/SDKDOC4/Accessing+Files+with+CryPak

https://docs.cryengine.com/display/CEPROG/Build+Automation
