# Инструкция по созданию XML-файла инструкции запуска уровня сервером Warface

## Зачем данный файл нужен?

Данный файл необходим серверу, чтобы:
1. В интерфейсе карта отображалась правильно, а именно её название, описания, иконка, режим и вообще, будет ли она отображаться;
2. При запуске имела корректный режим, время суток, TOD;
3. Имела необходимые значения наград и требования для них;
4. Соблюдались разного рода ограничения;
5. Ну и многие другие нюансы;

Без данного файла запустить карту через интерфейс не выйдет, а если и выйдет, то вероятнее всего карта не будет иметь необходимых настроек и функций.

## Создание файла для PvP-карты

Общий вид:
```xml
<mission name="" time_of_day="" game_mode="" game_mode_cfg="" uid="" release_mission="" clan_war_mission="" only_clan_war_mission="" channels="" rating_game_mission="" event_mission="">
  <Basemap name=""/>
  <TimeOfDay file="" start="" end="" speed="" />
  <UI>
    <Description text="" icon=""/>
    <GameMode text=""/>
  </UI>
  <Sublevels mission_flow="default" win_pool="" lose_pool="" draw_pool="" score_pool=""/>
  <TimeDependency min_time="" full_time="" />
  <KillDependency min_kills="" full_kills="" />
  <Objectives/>
  <Teleports/>
</mission>
```

### Начнём с главной ветки ```mission```:

```name``` - название карты на английском или ключ на название в локализации;

```time_of_day``` - время суток на карте в десятичном формате (например, если у вас на карте должно быть \[08:15\], то здесь вы пишете ```time_of_day="8.25"```);

```game_mode``` - техническое название режима;

```game_mode_cfg``` - полное название CFG-файла режима (например, если карта у вас для мясорубки, то вы пишите ```game_mode_cfg="ffa_mode.cfg"```);

```uid``` - уникальный идентификатор карты (уникальный идентификатор - это 128-битное целое число, в котором может использоваться: строчные латинские буквы, цифры, дефисы в качестве разделителей, общий вид: ```********-****-****-****-************```). Можно сгенерировать на сайте: [Free Online GUID Generator](https://www.guidgenerator.com/);

```release_mission``` - доступна ли карта в игре (```release_mission="1"``` - доступна, ```release_mission="0"``` - недоступна);

```clan_war_mission``` - доступна ли карта в клановых битвах (```clan_war_mission="1"``` - доступна, ```clan_war_mission="0"``` - недоступна);

```only_clan_war_mission``` - карта доступна исключительно в клановых битвах (```clan_war_mission="1"``` - да, ```clan_war_mission="0"``` - нет);

```channels``` - каналы, на которых карта будет доступна для игры ("pvp_newbie" - новички, "pvp_skilled" - общие, "pvp_pro" - ветераны. Возможно перечисление через запятую, например: ```channels="pvp_newbie, pvp_skilled, pvp_pro"```);

```rating_game_mission``` - возможно ли использовать карту в ротации рейтинговых матчей (```rating_game_mission="1"``` - да, ```rating_game_mission="0"``` - нет);

```event_mission``` - возможно ли использовать карту в рамках PvP-событий (```event_mission="1"``` - да, ```event_mission="0"``` - нет);

### Ветка ```Basemap```:

```name``` - путь до файла \[level.pak\] в папке \[Levels\] (например: ```name="pvp/tdm_farm"```);

### Ветка ```TimeOfDay``` (необязательна):

```file``` - путь до TOD-файла в клиенте (например: ```file="Libs/TimeOfDay/tdm_farm_sunset.tod"```);

```start``` - начальное время суток в десятичном формате;

```end``` - конечное время суток в десятичном формате;

```speed``` - скорость смены времени суток;

### Ветка ```UI```:

#### Ветка ```Description```:

```text``` - описание карты на английском или ключ на описание в локализации;

```icon``` - название иконки карты (название иконки прописывается в файле \[/libs/config/ui/mapimagespvp.xml\], под каждую иконку там указан путь и её размеры);

#### Ветка ```GameMode```:

```text``` - описание режима на английском или ключ на описание в локализации;

### Ветка ```Sublevels```:

```mission_flow``` - тип хода выполнения миссии, для PvP используется ```mission_flow="default"```;

```win_pool``` - значение награды при победе;

```lose_pool``` - значение награды при поражении;

```draw_pool``` - значение награды при ничьей;

```score_pool``` - значение награды, которая будет зависеть от счёта игрока набранном в бою, итоговое значение будет высчитываться по формуле: score_pool * (player_score / 1stplace_score), где score_pool - значение в файле, player_score - счёт игрока, 1stplace_score - счёт игрока на первом месте. Игрок на первом месте будет получать максимальное количество награды score_pool;

### Ветка ```TimeDependency```:

```min_time``` - минимальное количество времени в секундах, которое означает, что, если игра завершиться раньше этого времени, то игроки получат только минимальную награду, которая указана в файле \[/libs/config/masterserver/rewards_configuration.xml\];

```full_time``` - максимальное количество времени в секундах, которое означает, что, если игра завершиться позже этого времени, то награда не будет уменьшена в пропорции между значениями min_time и full_time;

### Ветка "KillDependency":

```min_kills``` - минимальное количество убийств в бою, которое означает, что, если за всю игру убийств будет меньше этого значения, то игроки получат только минимальную награду;

```full_kills``` - максимальное количество убийств в бою, которое означает, что, если за всю игру убийств будет больше или равно этому значению, то награда не будет уменьшена в пропорции между значениями min_kills и full_kills;

### Ветка ```Objectives```:

В данном случае остаётся пустой.

### Ветка ```Teleports```:

В данном случае остаётся пустой.

## Создание файла для PvE-миссии или спецоперации

Для PvE создание данного файла немного отличается, в нём также присутствуют те же параметры, что и в файле для PvP, но их здесь я повторять не буду, распишу только отличия.

Общий вид:
```xml
<mission name="" time_of_day="" game_mode="pve" game_mode_cfg="pve_mode.cfg" uid="" release_mission="" clan_war_mission="" only_clan_war_mission="" difficulty="" mission_type="" comics_intro="">
  <Basemap name=""/>
  <TimeOfDay file="" start="" end="" speed="" />
  <UI>
    <Description text="" icon=""/>
    <GameMode text=""/>
  </UI>
  <Sublevels>
    <Sublevel id="" name="" mission_flow="" score="" difficulty="" difficulty_cfg="" win_pool="" lose_pool="" draw_pool="" score_pool=""/>
  </Sublevels>
  <Objectives>
    <Objective type="primary" timelimit=""/>
    <Objective type="secondary" completion_score="" id=""/>
  </Objectives>
  <Teleports>
    <Teleport start_sublevel_id="" start_teleport="" finish_sublevel_id="" finish_teleport=""/>
  </Teleports>
</mission>
```

### Ветка ```mission```:

```difficulty``` - сложность миссии (виды сложностей: easy - легко; normal - сложно; hard - профи; survival - та же профи, но подрузумевает то, что у миссии одна сложность);

```mission_type``` - необходима для определения множителей к наградам, которые прописываются в файле \[/libs/config/masterserver/rewards_configuration.xml\];

```comics_intro``` - название XML-файла комикса из папки \[ui/comics/\], который может быть проигран в интефейсе;

### Ветка ```Sublevels```:

#### Ветка ```Sublevel```:

```id``` - номер Sublevel, отсчёт начинается с цифры 0;

```name``` - путь до файла \[submissionconfig.xml\] в папке \[Levels\], в котором будут прописаны основные значения наград. Инструкция по созданию файла \[submissionconfig.xml\] появится позже, пока можете попробовать создать его сами на основе имеющихся в клиенте файлов;

```mission_flow``` - тип хода выполнения миссии ("passage" - проход; "passage_backward" - проход в обратном направлении, используется для PvE-миссий, которое это поддерживают; "convoy" - сопровождение; "boss" - босс; "arena" - статичная арена, "arena_flow" - динамичная арена);

```score``` - счёт, за что отвечает, пока неизвестно, по умолчанию везде стоит ```score="0"```;

```difficulty``` - сложность миссии (виды сложностей: easy - легко; normal - сложно; hard - профи; survival - та же профи, но подрузумевает то, что у миссии одна сложность);

```difficulty_cfg``` - полное название CFG-файла сложности миссии (их нет в клиенте, данные файлы хранятся на сервере по пути: \[config/content/\]);

```win_pool``` - значение награды при победе (можно оставить ```win_pool="0"```, так как оно всё равно ни на что не влияет);

```lose_pool``` - значение награды при поражении (можно оставить ```lose_pool="0"```, так как оно всё равно ни на что не влияет);

```draw_pool``` - значение награды при ничьей (можно оставить ```draw_pool="0"```, так как оно всё равно ни на что не влияет);

```score_pool``` - значение награды, которая будет зависеть от счёта игрока, набранном в бою (можно оставить ```score_pool="0"```, так как оно всё равно ни на что не влияет);

Данных веток может быть несколько, в зависимости от того, из скольки уровней состоит ваша миссия.

### Ветка ```Objectives```:

#### Ветка ```Objective```:

```type``` - тип цели миссии ("primary" - основная цель; "secondary" - второстепенная цель;);

```timelimit``` - ограничение по времени в секундах, означающее, сколько максимально может длиться миссия, при истечении времени миссия завершится поражением;

```completion_score``` - количество очков, которое необходимо для выполнения данной цели;

```id``` - id цели, которая указывается в файле \[/libs/config/secondaryobjectivesdesc.xml\];

### Ветка ```Teleports```:

#### Ветка ```Teleport```:

```start_sublevel_id``` - номер стартовой миссии (из ветки ```Sublevels/Sublevel```), откуда будет производится телепорт;

```start_teleport``` - название входного телепорта, откуда будет производиться телепорт, название, возможно, задаётся на этапе создания уровня (точно не уверен);

```finish_sublevel_id``` - номер следующей миссии (из ветки ```Sublevels/Sublevel```), куда будет производиться телепорт;

```finish_teleport``` - название конечного телепорта, куда будет производиться телепорт, название, возможно, задаётся на этапе создания уровня (точно не уверен);

# Подведение итогов

На этом создание XML-файла инструкции запуска уровня сервером Warface завершено, данный файл вы можете назвать как угодно, но лучше всего назвать его также, как и ваш уровень (если у вас миссия, то название уровня миссии и её сложность). Данный файл должен находиться по пути: \[/libs/missions/\]. Теперь ваша карта или миссия готова для полноценного использования в игре!
